C51 COMPILER V8.01   IO_04                                                                 09/20/2013 12:26:01 PAGE 1   


C51 COMPILER V8.01, COMPILATION OF MODULE IO_04
OBJECT MODULE PLACED IN IO_04.OBJ
COMPILER INVOKED BY: C:\Program Files\Keil3\C51\BIN\C51.EXE IO_04.c BROWSE DEBUG OBJECTEXTEND TABS(8)

line level    source

   1          //======================================================================================
   2            char titel[]=  "\nIO_04_Name.c";   // Demo serielle Kommunikation
   3          
   4          //               Serielle Kommunikation                                                                    
             -     
   5          //  Name:                       Vorname:              Klasse:     Datum:     Platz:                       
             -                                                            
   6          //                                                                                     
   7          //==jak13===============================================================================
   8          //******************************* Quelltextdateien *************************************
   9          #include <Reg515c.h>            // Definition der Port-Bytes usw.
  10          //********************************** Konstanten ****************************************
  11          //******************************** globale Variablen ***********************************
  12          //****************************** Funktionsdeklarationen ********************************
  13          void main(void);
  14          void init_seriell(void);
  15          void putchar(char ch);
  16          void printstring(char *stringanfang);
  17          char getchar(void);
  18          //******************************** Hauptprogramm ***************************************
  19          void main(void) 
  20            {
  21   1        unsigned char c;
  22   1      
  23   1        if(BD == 0)                   // Baudratengenerator noch nicht aktiv
  24   1          init_seriell();             // serielle Kommunikation ermöglichen
  25   1        printstring(titel);
  26   1        putchar('\n');
  27   1          while(1)
  28   1          {
  29   2          c=getchar();
  30   2          putchar(c+1);
  31   2          }
  32   1        }
  33          //***************************** F u n k t i o n e n ************************************
  34          void init_seriell(void) 
  35            {
  36   1        SCON  = 0x50;         // SCON: mode 1, 8-bit UART, enable rcvr 
  37   1        PCON |= 0x80;         // SMOD Bit setzen 
  38   1        SRELH = 0x03;         // 9600 baud @ 10MHz für C515C
  39   1        SRELL = 0xBF;
  40   1        BD    = 1;            // Baudratengenerator verwenden
  41   1        TI    = 1;            // TI:   "vorausgegangenes Transmit" beendet
  42   1        }
  43          //---------------------------------------------------------------------------------------
  44          void putchar(char ch)
  45            {
  46   1        while(TI != 1);       // voriges Transmit Ende abwarten
  47   1        TI=0;                 // für nächste Übertragung löschen
  48   1        SBUF=ch;              // Byte der Variablen ch seriell senden
  49   1        }
  50          //---------------------------------------------------------------------------------------
  51          void printstring(char *cp)
  52            {
  53   1        for(; *cp != '\0'; cp++)
C51 COMPILER V8.01   IO_04                                                                 09/20/2013 12:26:01 PAGE 2   

  54   1             putchar(*cp);            // Zeichen seriell ausgeben
  55   1        }
  56          //---------------------------------------------------------------------------------------
  57          char getchar(void)
  58            {
  59   1        char cget;
  60   1      
  61   1        do{  
  62   2          while(!RI);           // Receive Ende abwarten (in dScope Serial Window TASTENDRUCK!)
  63   2          cget=SBUF;            // seriell empfangenes Byte in Variable cget übernehmen
  64   2          RI=0;                 // Meldung: kann neue Daten empfangen
  65   2          }while(cget==0x11);
  66   1        return(cget);
  67   1        }
  68          //---------------------------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     91    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     14       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
