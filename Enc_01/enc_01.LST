C51 COMPILER V8.01   ENC_01                                                                12/11/2013 08:59:03 PAGE 1   


C51 COMPILER V8.01, COMPILATION OF MODULE ENC_01
OBJECT MODULE PLACED IN enc_01.OBJ
COMPILER INVOKED BY: C:\Program Files\Keil3\C51\BIN\C51.EXE enc_01.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          //=======================================================================================
   2          /*
   3            RS | Jakowski | Hellweg Berufskolleg
   4            Jurij Vasilenko | ITAM2 | 6. November 2013
   5            Enc_01
   6          */
   7          //=======================================================================================
   8          //************************ Quelltextdatein **********************************************
   9          #include <Reg515c.h>
  10          //************************* Konstanten **************************************************
  11          sbit P1_0=P1^0;
  12          sbit P1_4=P1^4;
  13          //****************************** Funktionsdeklarationen *********************************
  14          void main(void);
  15          void init_seriell(void);
  16          void putchar(char ch);
  17          void printstring(char *cp);
  18          void printuintdez(unsigned int x);
  19          //******************************** Hauptprogramm ****************************************
  20          //---------------------------------------------------------------------------------------
  21          void main(void)
  22          {
  23   1        char dir;
  24   1        int count=0xFFFF;
  25   1        bit a, aalt, b, balt;
  26   1      
  27   1        if(BD==0)
  28   1          init_seriell();
  29   1        a=b=aalt=balt;
  30   1      
  31   1        while(1)
  32   1        {
  33   2          a=P1_0;
  34   2          b=P1_4;
  35   2          if(b==0 && aalt==0 && a==1||b==1 && aalt==1 && a==0||a==1 && balt==0 && b==1||a==0 && balt==1 && b==0)
  36   2            dir++;
  37   2          if(b==0 && aalt==1 && a==0||b==1 && aalt==0 && a==1||a==0 && balt==0 && b==1||a==1 && balt==1 && b==0)
             - 
  38   2            dir--;
  39   2      
  40   2          aalt=a;
  41   2          balt=b;
  42   2      
  43   2          if(dir!=0)
  44   2          {
  45   3            if(dir>=1)
  46   3              count++;
  47   3            if(dir<=-1)
  48   3              count--;
  49   3            printuintdez(count);
  50   3            dir=0;
  51   3            putchar('\n');  
  52   3          }
  53   2        }
  54   1      }
C51 COMPILER V8.01   ENC_01                                                                12/11/2013 08:59:03 PAGE 2   

  55          //***************************** F u n k t i o n e n *************************************
  56          void init_seriell(void) 
  57          {
  58   1        SCON  = 0x50;  // SCON: mode 1, 8-bit UART, enable rcvr 
  59   1        PCON |= 0x80;  // SMOD Bit setzen 
  60   1        SRELH = 0x03;  // 9600 baud @ 10MHz für C515C
  61   1        SRELL = 0xBF;
  62   1        BD    = 1;  // Baudratengenerator verwenden
  63   1        TI    = 1;  // TI:   "vorausgegangenes Transmit" beendet
  64   1      }
  65          //---------------------------------------------------------------------------------------
  66          void putchar(char ch)
  67          {
  68   1        while(TI != 1);  // voriges Transmit Ende abwarten
  69   1        TI=0;  // für nächste Übertragung löschen
  70   1        SBUF=ch;  // Byte der Variablen ch seriell senden
  71   1      }
  72          //---------------------------------------------------------------------------------------
  73          void printuintdez(unsigned int x)
  74          {
  75   1        putchar(x%100000/10000+'0');
  76   1        putchar(x%10000/1000+'0');
  77   1        putchar(x%1000/100+'0');
  78   1        putchar(x%100/10+'0');
  79   1        putchar(x%10+'0');
  80   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    312    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       4
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
